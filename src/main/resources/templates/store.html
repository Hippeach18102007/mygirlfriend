<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C·ª≠a Ti·ªám H·∫°nh Ph√∫c üè™</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* --- PH·∫¶N CSS (Giao di·ªán) --- */
        body {
            background-color: #f3e5f5;
            font-family: 'Nunito', sans-serif;
            margin: 0;
            padding: 20px;
        }

        /* Thanh hi·ªÉn th·ªã ti·ªÅn */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            padding: 15px 30px;
            border-radius: 50px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            position: sticky;
            top: 20px;
            z-index: 100;
            max-width: 800px;
            margin: 0 auto 30px auto;
        }

        .logo {
            font-family: 'Fredoka One', cursive;
            color: #9c27b0;
            font-size: 1.5rem;
        }

        .wallet {
            display: flex;
            align-items: center;
            gap: 10px;
            background: #f3e5f5;
            padding: 5px 20px;
            border-radius: 30px;
            font-weight: bold;
            color: #7b1fa2;
        }

        .coin-icon { width: 25px; height: 25px; }

        /* Khu v·ª±c ƒëi·ªÉm danh */
        .earn-section {
            text-align: center;
            margin-bottom: 40px;
        }

        .btn-checkin {
            background: linear-gradient(45deg, #ff4081, #f50057);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(245, 0, 87, 0.4);
            transition: transform 0.2s;
        }

        .btn-checkin:active { transform: scale(0.95); }
        .btn-checkin:disabled { background: #ccc; cursor: not-allowed; box-shadow: none; }

        /* L∆∞·ªõi s·∫£n ph·∫©m */
        .shop-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            max-width: 1000px;
            margin: 0 auto;
        }

        .product-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            transition: transform 0.3s;
            display: flex;
            flex-direction: column;
        }

        .product-card:hover { transform: translateY(-10px); }

        .product-img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-bottom: 2px solid #f3e5f5;
        }

        .product-info {
            padding: 15px;
            text-align: center;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .product-name {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .product-price {
            color: #f50057;
            font-weight: bold;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .btn-buy {
            background-color: #9c27b0;
            color: white;
            border: none;
            padding: 8px 0;
            width: 100%;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
        }

        .btn-buy:hover { background-color: #7b1fa2; }

        .btn-back {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: white;
            padding: 10px 20px;
            border-radius: 30px;
            text-decoration: none;
            color: #333;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>

<a href="/" class="btn-back">‚¨Ö V·ªÅ Trang Ch·ªß</a>

<div class="header">
    <div class="logo">Love Store üè™</div>
    <div class="wallet">
        <img src="https://cdn-icons-png.flaticon.com/512/138/138292.png" class="coin-icon">
        <span id="user-balance">0</span> Xu
    </div>
</div>

<div class="earn-section">
    <button class="btn-checkin" onclick="dailyCheckIn()" id="checkinBtn">
        üìÖ ƒêi·ªÉm Danh H√†ng Ng√†y (+100 Xu)
    </button>
    <p style="color: #666; font-size: 0.9rem; margin-top: 10px;">
        (Ho√†n th√†nh nhi·ªám v·ª• ngo√†i ƒë·ªùi ƒë·ªÉ anh c·ªông th√™m xu nh√©!)
    </p>
</div>

<div class="shop-grid" id="shop-container">
</div>

<script>
    // 1. DANH S√ÅCH S·∫¢N PH·∫®M (B·∫°n c√≥ th·ªÉ th√™m b·ªõt t√πy √Ω)
    const products = [
        { name: "V√© ƒêi Xem Phim", price: 500, img: "https://media.giphy.com/media/13CoXDiaCcCoyk/giphy.gif" },
        { name: "Tr√† S·ªØa Full Topping", price: 200, img: "https://media.giphy.com/media/LpdlqTkgO2Lwwixwv7/giphy.gif" },
        { name: "1 L·∫ßn G·ªôi ƒê·∫ßu", price: 300, img: "https://media.giphy.com/media/ZBQhoZC0nqknSviPqT/giphy.gif" },
        { name: "Anh R·ª≠a B√°t 1 Ng√†y", price: 150, img: "https://media.giphy.com/media/xT1R9YBfq6y6Y7xLzO/giphy.gif" },
        { name: "Massage Ch√¢n 30p", price: 250, img: "https://media.giphy.com/media/l41lFw057lAJcYt0Y/giphy.gif" },
        { name: "V√© 'X√≥a D·ªói'", price: 1000, img: "https://media.giphy.com/media/3o7TKoWXm3okO1kgHC/giphy.gif" },
        { name: "ƒÇn ƒê√™m (Ship T·∫≠n Gi∆∞·ªùng)", price: 400, img: "https://media.giphy.com/media/12FpQVlmcsi49i/giphy.gif" },
        { name: "√îm 1 C√°i (Free)", price: 0, img: "https://media.giphy.com/media/4N1wOi78ZGz54SYCtA/giphy.gif" }
    ];

    // 2. LOGIC V√ç TI·ªÄN (L∆∞u trong tr√¨nh duy·ªát c·ªßa c√¥ ·∫•y)
    let balance = parseInt(localStorage.getItem('loveCoins')) || 0;

    const balanceEl = document.getElementById('user-balance');

    function updateBalanceUI() {
        balanceEl.innerText = balance;
    }
    updateBalanceUI(); // Ch·∫°y ngay khi m·ªü trang

    // 3. HI·ªÇN TH·ªä S·∫¢N PH·∫®M L√äN M√ÄN H√åNH
    const shopContainer = document.getElementById('shop-container');
    products.forEach(p => {
        const card = document.createElement('div');
        card.className = 'product-card';
        card.innerHTML = `
                <img src="${p.img}" class="product-img">
                <div class="product-info">
                    <div class="product-name">${p.name}</div>
                    <div class="product-price">
                        <img src="https://cdn-icons-png.flaticon.com/512/138/138292.png" width="15">
                        ${p.price} Xu
                    </div>
                    <button class="btn-buy" onclick="buyItem('${p.name}', ${p.price})">MUA NGAY</button>
                </div>
            `;
        shopContainer.appendChild(card);
    });

    // 4. CH·ª®C NƒÇNG ƒêI·ªÇM DANH (Ki·∫øm ti·ªÅn)
    function dailyCheckIn() {
        const lastCheckIn = localStorage.getItem('lastCheckInDate');
        const today = new Date().toISOString().slice(0, 10);

        if (lastCheckIn === today) {
            alert("H√¥m nay em ƒëi·ªÉm danh r·ªìi m√†! Mai quay l·∫°i nh√© üòò");
            return;
        }

        // C·ªông ti·ªÅn
        balance += 100;
        localStorage.setItem('loveCoins', balance);
        localStorage.setItem('lastCheckInDate', today);

        updateBalanceUI();
        alert("ƒêi·ªÉm danh th√†nh c√¥ng! Em nh·∫≠n ƒë∆∞·ª£c 100 Xu ‚ù§Ô∏è");

        // Kh√≥a n√∫t ƒëi·ªÉm danh
        disableCheckinBtn();
    }

    function disableCheckinBtn() {
        const btn = document.getElementById('checkinBtn');
        btn.innerText = "ƒê√£ ƒêi·ªÉm Danh H√¥m Nay";
        btn.disabled = true;
    }

    // Ki·ªÉm tra xem h√¥m nay ƒë√£ ƒëi·ªÉm danh ch∆∞a khi v·ª´a v√†o trang
    const lastCheckIn = localStorage.getItem('lastCheckInDate');
    const today = new Date().toISOString().slice(0, 10);
    if (lastCheckIn === today) {
        disableCheckinBtn();
    }

    // 5. CH·ª®C NƒÇNG MUA H√ÄNG (G·ª≠i th√¥ng b√°o v·ªÅ Discord/Telegram)
    function buyItem(name, price) {
        // Ki·ªÉm tra ti·ªÅn
        if (balance < price) {
            alert("Huhu, em kh√¥ng ƒë·ªß xu r·ªìi! H√£y chƒÉm ch·ªâ y√™u anh ƒë·ªÉ ki·∫øm th√™m nh√© ü•∫");
            return;
        }

        if(confirm(`Em c√≥ ch·∫Øc mu·ªën d√πng ${price} Xu ƒë·ªÉ mua "${name}" kh√¥ng?`)) {
            // Tr·ª´ ti·ªÅn ngay l·∫≠p t·ª©c (cho c·∫£m gi√°c m∆∞·ª£t)
            balance -= price;
            localStorage.setItem('loveCoins', balance);
            updateBalanceUI();

            // G·ª≠i y√™u c·∫ßu v·ªÅ Server (Java) ƒë·ªÉ b√°o tin
            // Server s·∫Ω d√πng Telegram ho·∫∑c Discord Service ƒë·ªÉ b√°o cho b·∫°n
            fetch(`/api/buy-item?itemName=${encodeURIComponent(name)}&price=${price}`, {
                method: 'POST'
            })
                .then(res => res.text())
                .then(data => {
                    // Th√¥ng b√°o th√†nh c√¥ng t·ª´ Server tr·∫£ v·ªÅ
                    alert(data);
                })
                .catch(err => {
                    alert("L·ªói m·∫°ng! Xu ƒë√£ tr·ª´ nh∆∞ng anh ch∆∞a nh·∫≠n ƒë∆∞·ª£c tin. Em ch·ª•p m√†n h√¨nh g·ª≠i anh nh√©!");
                });
        }
    }
</script>
</body>
</html>