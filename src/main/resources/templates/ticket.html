<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>T·∫•m V√© T∆∞∆°ng Lai üé´</title>
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
  <style>
    body {
      background-color: #e0e5ec;
      font-family: 'Roboto', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
    }

    h1 {
      color: #374785;
      font-family: 'Oswald', sans-serif;
      text-transform: uppercase;
      letter-spacing: 2px;
      margin-bottom: 30px;
      text-align: center;
    }

    /* Bao ngo√†i t·∫•m v√© */
    .ticket {
      display: flex;
      width: 100%;
      max-width: 750px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      overflow: hidden;
      position: relative;
    }

    /* Ph·∫ßn th√¢n v√© (Tr√°i) */
    .ticket-left {
      flex: 2;
      padding: 20px;
      border-right: 2px dashed #ccc;
      position: relative;
    }

    /* Ph·∫ßn cu·ªëng v√© (Ph·∫£i) */
    .ticket-right {
      flex: 1;
      padding: 20px;
      background: #374785;
      color: white;
      display: flex;
      flex-direction: column;
      justify-content: center;
      position: relative;
    }

    /* T·∫°o h√¨nh b√°n nguy·ªát ·ªü ƒë∆∞·ªùng c·∫Øt */
    .ticket-left::after, .ticket-right::before {
      content: '';
      position: absolute;
      width: 30px; height: 30px;
      background: #e0e5ec;
      border-radius: 50%;
    }
    .ticket-left::after { top: -15px; right: -15px; }
    .ticket-right::before { bottom: -15px; left: -15px; }

    /* N·ªôi dung v√© */
    .header {
      display: flex;
      justify-content: space-between;
      border-bottom: 2px solid #374785;
      padding-bottom: 10px;
      margin-bottom: 20px;
    }

    .airline { font-family: 'Oswald', sans-serif; font-size: 1.5rem; color: #374785; }
    .class { font-weight: bold; color: #f76c6c; text-transform: uppercase; }

    .flight-info {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .airport { text-align: center; }
    .code { font-size: 2.5rem; font-weight: bold; color: #333; display: block; font-family: 'Oswald', sans-serif; }
    .city { font-size: 0.9rem; color: #777; text-transform: uppercase; }

    .plane-icon {
      align-self: center;
      font-size: 2rem;
      color: #374785;
      transform: rotate(90deg);
    }

    .details {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
    }

    .label { font-size: 0.75rem; color: #999; text-transform: uppercase; letter-spacing: 1px; }
    .value { font-weight: bold; color: #333; font-size: 1.1rem; }

    /* Cu·ªëng v√© ph·∫£i */
    .ticket-right .code { color: white; font-size: 2rem; }
    .ticket-right .city { color: rgba(255,255,255,0.7); }
    .barcode {
      margin-top: auto;
      height: 40px;
      background: repeating-linear-gradient(90deg, #fff, #fff 2px, transparent 2px, transparent 4px);
      width: 100%;
    }

    /* N√∫t Check-in */
    .btn-checkin {
      margin-top: 30px;
      padding: 15px 40px;
      background: #f76c6c;
      color: white;
      border: none;
      border-radius: 50px;
      font-size: 1.2rem;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 5px 15px rgba(247, 108, 108, 0.4);
      transition: transform 0.2s;
      text-transform: uppercase;
    }

    .btn-checkin:hover { background: #ff5f5f; }
    .btn-checkin:active { transform: scale(0.95); }
    .btn-checkin:disabled { background: #ccc; cursor: default; box-shadow: none; }

    /* Con d·∫•u CONFIRMED */
    .stamp {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%) rotate(-15deg) scale(0);
      border: 5px solid #2ecc71;
      color: #2ecc71;
      font-size: 2.5rem;
      font-weight: bold;
      text-transform: uppercase;
      padding: 10px 20px;
      border-radius: 10px;
      opacity: 0;
      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      z-index: 10;
      background: rgba(255,255,255,0.9);
      font-family: 'Oswald', sans-serif;
    }

    .stamp.show {
      transform: translate(-50%, -50%) rotate(-15deg) scale(1);
      opacity: 1;
    }

    /* Responsive */
    @media (max-width: 600px) {
      .ticket { flex-direction: column; }
      .ticket-left { border-right: none; border-bottom: 2px dashed #ccc; }
      .ticket-right { flex-direction: row; justify-content: space-between; align-items: center; }
      .barcode { width: 50px; height: 100%; transform: rotate(90deg); margin: 0; }
      .ticket-left::after { bottom: -15px; right: -15px; top: auto; }
      .ticket-right::before { top: -15px; left: -15px; bottom: auto; }
    }
  </style>
</head>
<body>

<h1>‚ú® T·∫•m V√© T∆∞∆°ng Lai ‚ú®</h1>

<div class="ticket">

  <div class="ticket-left">
    <div class="stamp" id="stamp">CONFIRMED</div>

    <div class="header">
      <div class="airline">LOVE AIRLINES ‚ù§Ô∏è</div>
      <div class="class">First Class (VIP)</div>
    </div>

    <div class="flight-info">
      <div class="airport">
        <span class="code">MISS</span>
        <span class="city">N·ªói Nh·ªõ (Qu√¢n S·ª±)</span>
      </div>
      <div class="plane-icon">‚úà</div>
      <div class="airport">
        <span class="code">LOVE</span>
        <span class="city">H·∫°nh Ph√∫c (B√™n Nhau)</span>
      </div>
    </div>

    <div class="details">
      <div>
        <div class="label">H√†nh Kh√°ch</div>
        <div class="value">V·ª£ Y√™u C·ªßa Anh</div>
      </div>
      <div>
        <div class="label">Ng√†y Bay</div>
        <div class="value">30 DEC 2025</div>
      </div>
      <div>
        <div class="label">Gi·ªù</div>
        <div class="value">11:00 AM</div>
      </div>
      <div style="margin-top: 15px;">
        <div class="label">C·ª≠a (Gate)</div>
        <div class="value">A01</div>
      </div>
      <div style="margin-top: 15px;">
        <div class="label">Gh·∫ø (Seat)</div>
        <div class="value">1A (C·∫°nh Anh)</div>
      </div>
    </div>
  </div>

  <div class="ticket-right">
    <div>
      <span class="code">LOVE</span>
      <div class="city" style="color:rgba(255,255,255,0.8)">From: MISS</div>
    </div>
    <div style="margin: 10px 0;">
      <div class="label" style="color:rgba(255,255,255,0.6)">Passenger</div>
      <div class="value" style="color:white; font-size: 1rem;">V·ª£ Y√™u</div>
    </div>
    <div class="barcode"></div>
  </div>
</div>

<button class="btn-checkin" id="btnCheckin" onclick="doCheckIn()">CHECK-IN NGAY</button>

<p style="margin-top: 20px; color: #555; text-align: center; max-width: 500px;">
  "T·∫•m v√© n√†y l√† l·ªùi h·ª©a c·ªßa anh. Ng√†y anh ra qu√¢n (30/12), ch√∫ng m√¨nh s·∫Ω c√πng nhau ƒëi m·ªôt chuy·∫øn th·∫≠t xa ƒë·ªÉ b√π ƒë·∫Øp nh·ªØng ng√†y xa c√°ch nh√©!"
</p>

<a href="/" style="margin-top: 30px; text-decoration: none; color: #374785; font-weight: bold;">‚¨Ö V·ªÅ Trang Ch·ªß</a>

<script>
  function doCheckIn() {
    // Ki·ªÉm tra n·∫øu ƒë√£ check-in r·ªìi
    if (localStorage.getItem('ticket_checked')) {
      alert("Em ƒë√£ check-in r·ªìi m√†! V√© ƒë√£ ƒë∆∞·ª£c gi·ªØ ch·ªó an to√†n ‚ù§Ô∏è");
      return;
    }

    if (confirm("Em ƒë·ªìng √Ω check-in v√† ch·ªù ƒë·ª£i chuy·∫øn ƒëi n√†y c√πng anh ch·ª©?")) {
      const btn = document.getElementById('btnCheckin');
      btn.innerText = "ƒêANG X·ª¨ L√ù...";
      btn.disabled = true;

      fetch('/api/check-in', { method: 'POST' })
              .then(res => {
                if (res.ok) {
                  // Hi·ªán con d·∫•u
                  document.getElementById('stamp').classList.add('show');

                  btn.innerText = "ƒê√É CHECK-IN TH√ÄNH C√îNG ‚úÖ";
                  localStorage.setItem('ticket_checked', 'true');

                  alert("Tuy·ªát v·ªùi! Anh ƒë√£ nh·∫≠n ƒë∆∞·ª£c x√°c nh·∫≠n. H·∫πn em ng√†y ƒë√≥ nh√©!");
                }
              })
              .catch(err => {
                alert("L·ªói m·∫°ng, nh∆∞ng anh bi·∫øt em ƒë·ªìng √Ω r·ªìi ^^");
                document.getElementById('stamp').classList.add('show');
              });
    }
  }

  // Ki·ªÉm tra tr·∫°ng th√°i khi t·∫£i trang
  if (localStorage.getItem('ticket_checked')) {
    document.getElementById('stamp').classList.add('show');
    const btn = document.getElementById('btnCheckin');
    btn.innerText = "ƒê√É CHECK-IN TH√ÄNH C√îNG ‚úÖ";
    btn.disabled = true;
  }
</script>

</body>
</html>